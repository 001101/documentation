# 群发邮件

## 如何群发邮件

在你的CRM中要有至少一张带有目标记录的“目标列表”，还要有“邮件模板”。

1. 创建状态为`邮件`或`通讯`的新“活动”（Campaign）。在`目标列表`字段中选择一份或者若干份目标清单。
2. “活动”记录创建之后，为这项活动创建“群发邮件”：在“群发邮件”面板点击“＋”。指定 _开始日期_ ，即邮件发送的日期，然后选择 _邮件模板_ 。确保 _状态_ 设置为`待定`。

如果全部设置妥当，邮件应该可以顺利发送。邮件应该是每小时发送一部分（每个小时的发送量可以在“管理”>“发送邮件”中进行设置。）管理员可以更新`查看群邮件账户`中的`安排`字段，安排邮件工作。

在“日志”面板，可以检查邮件是否已正常发送。

## 测试收件人会收到什么样的邮件

点击 _群发邮件_ 面板里“群发邮件”行右边的下拉菜单，然后点击 _发送测试_ 。

## 日志

在日志部分，你可以看到：
* 已发送的邮件；
* 收件人打开过的邮件；
* 收件人点击过的链接；
* 不再订阅的收件人；
* 被退回的邮件（Bounced emails）（没有发送到收件人）。

## 退订链接

系统默认会在全部发出的邮件中加上退订链接。在“邮件模板”中，你也可以对这种链接进行自定义。

这是一个代码示例：
```html
<a href="{optOutUrl}">在邮件列表中取消订阅。</a>
```

默认情况下系统强制性地添加退订链接，管理员可以停用这一设置，在“管理”>“发送邮件”处设置即可。

## 跟踪链接

如果你想知道收件人有没有打开邮件中的链接，你需要创建“跟踪链接”。指定 _名称_ 
和你的链接指向的 _URL_ 。然后把生成的代码粘贴到邮件模板中。

这是一个代码示例：
```html
<a href="{trackingUrl:55f2c87b09a220a78}">看看我们的演示</a>
```

## 目标列表

“目标列表”包含“账户”列表、“联系人”列表、“潜在客户”列表和“用户”记录。

使用“目标列表”细节视图中相应面板上的 _选择_ 操作，用户就可以手动填写目标列表中的一些内容。你可以进行筛选，然后选择全部搜索结果。

## 用报告填写目标列表

[报告](reports.md#syncing-with-target-lists)功能能将与特定标准相配的记录填入目标列表中。

## 排除式目标列表

指定“排除式目标列表”可以避免把群发邮件发送到某些收件人那里。如果一条记录带有与任何排除式记录中的邮箱地址相匹配的邮箱地址，那么这条记录也会被排除。

## 活动日志

在“活动日志”中，你可以看到已发送的邮件、已阅邮件、退回的邮件、取消订阅的人和点击了邮件中链接的人。你可以这样利用这份日志：用基于来自日志的记录来创建“目标列表”（面板右上角的下拉菜单）。例如，单单挑选出那些点击了链接（跟踪链接）的联系人。

## 疑难解答

 _写给管理员_ 

#### 邮件没有发出时如何处理

1. 检查 _发送测试_ 是否正常运作。如果不正常，继续检查系统SMTP设置是否正确。
2. 检查有没有为你的系统设置cron。
3. 检查`发送群发邮件`是否已经设置为“已安排工作”以及它是否处在`已启用`状态（“管理”>“已安排工作”>“发送群发邮件”）。检查日志中有没有什么记录。


#### 假如跟踪链接的URL不正确，连接不到你的CRM时如何处理

检查`data/config.php`文件中的“siteUrl”参数。它必须设为你的EspoCRM可从外部访问的URL。

#### 被退回的邮件没有记录在日志中

退回邮件只可以由群组邮件账户处理。确保你有一个监视着退信接收的邮箱的群组邮件账户。

一些邮件服务器提供商也可能会偏离标准，所以，是不是真的退信可能无法区分。
