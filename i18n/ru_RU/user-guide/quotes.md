# Котировки

Функция котировок доступна в [Advanced Pack](https://www.espocrm.com/extensions/advanced-pack/).

Котировки представляют собой определенную группу продуктов или услуг с их количеством и ценами, которые вы указываете клиентам.

Котировки связаны с возможностями. Вы можете добавить «Котировки» в панель «Возможностей». Например вот так: «Администрирование» > «Менеджер компоновки» > «Возможности» > «Отношения». При создании новой котировки, связанной с возможностью, она передает элементы возможности в котировку.

Вы можете добавить панель котировок в свой аккаунт, чтобы иметь возможность видеть связанные котировки. Это можно сделать: Администрирование > менеджер компоновки > аккаунты > отношения.

## Котировки товаров

Котировка имеет список предметов. Каждый элемент может представлять определенный продукт или услугу с указанием количества, налоговой ставки, списка цен и цену за единицу. Можно сортировать элементы вручную.

Существует возможность добавлять поля custon для объекта Quote Item с помощью Entity Manager.

## Шаблоны

По умолчанию есть два доступных шаблона: Quote и Invoice. Вы можете создавать новые шаблоны (Список котировок > Меню справа вверху > Шаблоны), а также редактировать существующие.

Для более точного редактирования рекомендуется использовать режим просмотра кода.

Вы можете печатать поля записи котировок, а также поля соответствующих записей, используя заполнители в вашем шаблоне.

Примеры:
`{{accountName}}` – Имя аккаунта,

`{{{billingAddressStreet}}}` – адрес,

`{{account.type}}` – тип учетной записи,

`{{assignedUser.lastName}}` – последнее имя присвоенное пользователю.

Если это продукт, вы можете печатать поля продукта.

Примеры:
`{{product.length}}`, 

`{{product.color}}`.

Длина и цвет - это пользовательские поля объекта Product в примерах.

Котировка по пунктам:

```
<!-- {{#each itemList}} -->
  <td>{{order}}</td>
  <td>{{name}}</td>
  <td>{{quantity}}</td>
  <td>{{product.weight}}</td>
  <td align="right">{{listPrice}}</td>
  <td align="right">{{unitPrice}}</td>
  <td align="right">{{amount}}</td>
<!-- {{/each}} -->
```

Можно напечатать поля изображения:

```
<img src="{{file imageId}}">
```
где `imageId` - имя поля настраиваемого изображения в элементе Quote, объединенное с суффиксом `Id`.

Для продукта:
```
<img src="{{file product.photoId}}">
```

Для отображения различных чисел (количество, unitPrice и т. д.), без дробной части (как целое) используйте следующие выражения (начиная с версии 4.8.3):
```
{{numberFormat quantity_RAW decimals=0}}
```

Пользовательское форматирование значений валюты (начиная с версии 4.8.3):
```
{{numberFormat unitPrice_RAW decimals=2 decimalPoint=',' thousandsSeparator=' '}}
```
Значение `10000.5` нужно напечатать вот так: `10 000,50`.

Для отображения текстовых полей (многострочных) используйте тройные фигурные скобки: `{{{description}}}`.

## Печать в PDF

Котировки могут быть напечатаны в формате PDF. Это действие доступно в раскрывающемся списке рядом с кнопкой «Редактировать» в подробном представлении котировки. Затем вам будет предложено выбрать «Шаблон».

## Email Quote

Котировку PDF можно отправить по электронной почте в виде вложения. Открыть запись цитаты, щелкнуть выпадающий список рядом с кнопкой «Редактировать» и щелчком по электронной почте «PDF».

## Автоматическая нумерация

Вы можете создать поле Number через Entity Manager для типа объекта Quote. Администрирование > Менеджер сущностей > Цитата > Поля > Добавить > Номер. Затем вам нужно поместить его в подробное представление с помощью менеджера компоновки.

Значение будет увеличено на каждую новую котировку. Существует возможность указать следующий номер, а также префикс.

## Налог по умолчанию

Доступно с EspoCRM 4.8.0.

1. Укажите учетную запись по умолчанию в Administration > Entity Manager > Quotes > fields > Tax > Default.
2. Укажите ставку налога по умолчанию в Administration> Entity Manager > Quotes > fields > Tax Rate > Default.

## Счета

Котировка может рассматриваться как счет, если ее статус стал «Подтвержден». Появляются поля _Date Invoiced_, _Invoice Number_. Вы можете использовать другой шаблон счетов для печати.
