# Портал

Портал предоставляет возможность доступа к конкретным данным и функциям crm для ваших клиентов и партнеров. Администратор может создавать несколько порталов. Каждый портал может иметь свои собственные настройки, dashlboard, список пользователей, настройки контроля доступа.

Чтобы создать портал, выберите «Администрирование» > «Порталы», нажмите кнопку «Создать портал».

* `Активен`. Если портал не будет доступен никому.
* `По умолчанию`. Означает, что портал будет доступен по более короткому URL: http(s)://YOUR_ESPO_URL/portal.
* `Роли`. Укажите одну или несколько ролей портала, которые будут применяться к пользователям, зарегистрированным на портале. Более подробная информация о ролях портала приведена ниже.
* `Tab List`. Вкладки, которые будут отображаться в панели навигации.
* `Макет панели инструментов`. Укажите панели, которые будут отображаться на главной странице портала. Обратите внимание, что пользователи портала не могут настроить свою панель.
* `URL`. Только для чтения. Ссылка, с которой вы можете получить доступ к порталу.

## Пользователи портала

Администраторы могут создавать пользователей портала.

1. Администрирование > Пользователи.
2. Нажмите правую раскрывающуюся папку рядом с Create User.
3. Нажмите «Создать пользователя портала».
4. Выберите «Контакт», с которым будет связан пользователь портала.
5. Заполните форму и нажмите «Сохранить».

Пользователь портала должен быть связан с записью портала, чтобы иметь возможность доступа к этому порталу.

## Роли портала

Роли портала похожи на обычные роли в EspoCRM, но с несколькими отличиями.

Уровень `not-set` запрещает доступ.
* Уровень `own` означает, что запись создается пользователем. Например: пользователь портала редактирует какой-то случай, и этот случай принадлежит этому пользователю.
* Уровень `account` означает, что запись связана с учетной записью, с которой связан пользователь портала.
* Уровень «контакт» означает, что запись связана с контактом, с которым связан пользователь портала.

Поля назначенных пользователей и команд читаются только для пользователей портала.

### Пример

Пользователи портала должны иметь возможность создавать случаи, просматривать дела, связанные с их учетной записью; они должны иметь возможность ознакомиться с базой знаний.

1. Откройте форму «Создать роль портала» («Администрирование» > «Роли портала» > «Создать роль»).
2. Включите доступ к Cases, установите: `create - yes, read - account, edit - no, delete - no, stream - account`.
3. Включите доступ к базе знаний, установите `create - no, read - account, edit - no, delete - no`.
4. Измените запись портала (Администрирование > Порталы). Выберите роль портала в поле «Роли», а затем сохраните.

## Доступ к порталу

URL-адрес портала можно найти в поле «URL» в записи портала. Также можно использовать инструменты настройки сервера (такие как mod_rewrite), чтобы иметь доступ к другому URL-адресу. Для этого случая вам нужно заполнить поле «Пользовательский URL».

### Доступ к порталу с помощью настраиваемого URL-адреса для сервера Apache

Пользовательский URL: my-portal-host-name.com.

#### crm.portal.conf
```
<VirtualHost *:80>
	DocumentRoot /path/to/espocrm/instance/
	ServerName my-portal-host-name.com

    <Directory /path/to/espocrm/instance/>
        Options Indexes FollowSymLinks
        AllowOverride All
        Order allow,deny
        allow from all
    </Directory>

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

ServerAlias my-portal-host-name.com

```

#### Модифицирование правил перезаписи

Укажите идентификатор записи портала вместо `{PORTAL_ID}`. Идентификатор записи портала может быть доступен в адресной строке вашего веб-браузера при открытии подробной информации о записи портала. Например: https://my-espocrm-url.com/#Portal/16b9hm41c069e6j24. 16b9hm41c069e6j24 - это идентификатор записи портала.

```
  RewriteCond %{HTTP_HOST} ^portal-host-name.com$
  RewriteRule ^client - [L]

  RewriteCond %{HTTP_HOST} ^portal-host-name.com$
  RewriteCond %{REQUEST_URI} !^/portal/{PORTAL_ID}/.*$
  RewriteRule ^(.*)$ /portal/{PORTAL_ID}/$1 [L]
```
